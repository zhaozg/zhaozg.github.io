<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>lua-openssl Documentation</title>
    <link rel="stylesheet" href="../ldoc_pale.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>lua-openssl</h1>


<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Functions">Functions</a></li>
<li><a href="#Class_ssl_ctx">Class ssl_ctx </a></li>
<li><a href="#Class_ssl">Class ssl </a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../modules/asn1.html">asn1</a></li>
  <li><a href="../modules/bio.html">bio</a></li>
  <li><a href="../modules/callback.html">callback</a></li>
  <li><a href="../modules/cipher.html">cipher</a></li>
  <li><a href="../modules/cms.html">cms</a></li>
  <li><a href="../modules/compat.html">compat</a></li>
  <li><a href="../modules/x509.crl.html">x509.crl</a></li>
  <li><a href="../modules/x509.req.html">x509.req</a></li>
  <li><a href="../modules/dh.html">dh</a></li>
  <li><a href="../modules/digest.html">digest</a></li>
  <li><a href="../modules/dsa.html">dsa</a></li>
  <li><a href="../modules/ec.html">ec</a></li>
  <li><a href="../modules/engine.html">engine</a></li>
  <li><a href="../modules/hmac.html">hmac</a></li>
  <li><a href="../modules/kdf.html">kdf</a></li>
  <li><a href="../modules/lbn.html">lbn</a></li>
  <li><a href="../modules/lhash.html">lhash</a></li>
  <li><a href="../modules/mac.html">mac</a></li>
  <li><a href="../modules/misc.html">misc</a></li>
  <li><a href="../modules/ocsp.html">ocsp</a></li>
  <li><a href="../modules/openssl.html">openssl</a></li>
  <li><a href="../modules/ts.html">ts</a></li>
  <li><a href="../modules/param.html">param</a></li>
  <li><a href="../modules/pkcs12.html">pkcs12</a></li>
  <li><a href="../modules/pkcs7.html">pkcs7</a></li>
  <li><a href="../modules/pkey.html">pkey</a></li>
  <li><a href="../modules/rsa.html">rsa</a></li>
  <li><a href="../modules/srp.html">srp</a></li>
  <li><strong>ssl</strong></li>
  <li><a href="../modules/th-lock.html">th-lock</a></li>
  <li><a href="../modules/util.html">util</a></li>
  <li><a href="../modules/x509.html">x509</a></li>
  <li><a href="../modules/x509.algor.html">x509.algor</a></li>
  <li><a href="../modules/x509.attribute.html">x509.attribute</a></li>
  <li><a href="../modules/x509.extension.html">x509.extension</a></li>
  <li><a href="../modules/x509.name.html">x509.name</a></li>
  <li><a href="../modules/x509.store.html">x509.store</a></li>
</ul>
<h2>Topics</h2>
<ul class="">
  <li><a href="../topics/README.md.html">README</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>ssl</code></h1>
<p>ssl modules to create SSL/TLS server or client, send and recv data over SSL channels.</p>
<p>
</p>
    <h3>Usage:</h3>
    <ul>
        <pre class="example">ssl = require(&apos;openssl&apos;).ssl
</pre>
    </ul>


<h2><a href="#Functions">Functions</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#ctx_new">ctx_new (protocol[, support_ciphers])</a></td>
	<td class="summary">create ssl_ctx object, which mapping to SSL_CTX in openssl.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#new">new ([method="TLS"])</a></td>
	<td class="summary">create a new SSL context object</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#alert_type">alert_type (alert[, long=false])</a></td>
	<td class="summary">get alert_type for ssl state</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#alert_desc">alert_desc (alert[, long=false])</a></td>
	<td class="summary">get alert_desc for ssl state</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#session_new">session_new ()</a></td>
	<td class="summary">create new SSL session object</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#session_read">session_read (input)</a></td>
	<td class="summary">read SSL session from BIO or string data</td>
	</tr>
</table>
<h2><a href="#Class_ssl_ctx">Class ssl_ctx </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:use">ssl_ctx:use (pkey, cert)</a></td>
	<td class="summary">tell ssl_ctx use private key and certificate, and check private key</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:add">ssl_ctx:add (clientca[, extra_chain_cert_array])</a></td>
	<td class="summary">add client ca cert and option extra chain cert</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:timeout">ssl_ctx:timeout ()</a></td>
	<td class="summary">get timeout</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:timeout">ssl_ctx:timeout (timeout)</a></td>
	<td class="summary">set timeout</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:mode">ssl_ctx:mode (clear, mode[, ...])</a></td>
	<td class="summary">clean given mode
mode support
&lsquo;enable_partial_write&rsquo;,&lsquo;accept_moving_write_buffer&rsquo;,&lsquo;auto_retry&rsquo;,&lsquo;no_auto_chain&rsquo;,&lsquo;release_buffers&rsquo;</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:options">ssl_ctx:options ()</a></td>
	<td class="summary">get options</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:options">ssl_ctx:options (option)</a></td>
	<td class="summary">set options</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:options">ssl_ctx:options (clear, option)</a></td>
	<td class="summary">clear options</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:version">ssl_ctx:version ()</a></td>
	<td class="summary">get min_proto_version and max_proto_version</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:options">ssl_ctx:options (min, max)</a></td>
	<td class="summary">set min_proto_version and max_proto_version</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:quiet_shutdown">ssl_ctx:quiet_shutdown ()</a></td>
	<td class="summary">get quit_shutdown is set or not
Normally when a SSL connection is finished, the parties must send out
&ldquo;close notify&rdquo; alert messages using <strong><em>SSL:shutdown"</em></strong> for a clean shutdown.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:quiet_shutdown">ssl_ctx:quiet_shutdown (quiet)</a></td>
	<td class="summary">set quiet_shutdown</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:verify_locations">ssl_ctx:verify_locations (cafile, capath)</a></td>
	<td class="summary">set verify locations with cafile and capath
ssl_ctx:verify_locations specifies the locations for <em>ctx</em>, at
which CA certificates for verification purposes are located.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:cert_store">ssl_ctx:cert_store ()</a></td>
	<td class="summary">get certificate verification store of ssl_ctx</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:cert_store">ssl_ctx:cert_store (store)</a></td>
	<td class="summary">set or replaces then certificate verification store of ssl_ctx</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:set_engine">ssl_ctx:set_engine (eng)</a></td>
	<td class="summary">set client certificate engine for SSL context</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:ssl">ssl_ctx:ssl (fd[, server=false])</a></td>
	<td class="summary">create ssl object</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:ssl">ssl_ctx:ssl (input[, ouput=input[, server=false]])</a></td>
	<td class="summary">create ssl object</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:bio">ssl_ctx:bio (host_addr[, server=false[, autoretry=true]])</a></td>
	<td class="summary">create bio object</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:verify_depth">ssl_ctx:verify_depth ()</a></td>
	<td class="summary">get verify depth when cert chain veirition</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:verify_depth">ssl_ctx:verify_depth (depth)</a></td>
	<td class="summary">set verify depth when cert chain veirition</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:verify_mode">ssl_ctx:verify_mode ()</a></td>
	<td class="summary">get verify_mode, return number mode and all string modes list</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:verify_mode">ssl_ctx:verify_mode (mode[, ssl=nil])</a></td>
	<td class="summary">set ssl verify mode and callback</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:set_cert_verify">ssl_ctx:set_cert_verify ([cert_verify_cb])</a></td>
	<td class="summary">set certificate verify callback function</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:set_cert_verify">ssl_ctx:set_cert_verify (verify_cb_flag)</a></td>
	<td class="summary">set certificate verify options</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:set_alpn_protos">ssl_ctx:set_alpn_protos (protos)</a></td>
	<td class="summary">set the list of client ALPN protocols available to be negotiated by the server</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:set_alpn_select_cb">ssl_ctx:set_alpn_select_cb ([alpn_select_cb])</a></td>
	<td class="summary">set ALPN server protocol selection callback to select which protocol to use for the incoming
connection</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:set_tmp">ssl_ctx:set_tmp (keytype, tmp_cb[, vararg])</a></td>
	<td class="summary">set temp callback</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:set_tmp">ssl_ctx:set_tmp (keytype[, private])</a></td>
	<td class="summary">set tmp key content pem format</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:set_servername_callback">ssl_ctx:set_servername_callback (info)</a></td>
	<td class="summary">set servername callback</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:set_session_callback">ssl_ctx:set_session_callback (new, get, remove)</a></td>
	<td class="summary">set session callback</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:flush">ssl_ctx:flush ()</a></td>
	<td class="summary">flush sessions</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:sessions">ssl_ctx:sessions ()</a></td>
	<td class="summary">set ssl session</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:session_cache_mode">ssl_ctx:session_cache_mode ()</a></td>
	<td class="summary">get current session cache mode</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:session_cache_mode">ssl_ctx:session_cache_mode (mode)</a></td>
	<td class="summary">set session cache mode,and return old mode</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:num_tickets">ssl_ctx:num_tickets ([num])</a></td>
	<td class="summary">get or set number of TLS tickets</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:getpeerverification">ssl_ctx:getpeerverification ()</a></td>
	<td class="summary">get peer certificate verify result</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:time">ssl_ctx:time ([time])</a></td>
	<td class="summary">get or set SSL session time</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:timeout">ssl_ctx:timeout ([timeout])</a></td>
	<td class="summary">get or set SSL session timeout</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:peer">ssl_ctx:peer ()</a></td>
	<td class="summary">get peer certificate from SSL session</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:id">ssl_ctx:id ([id])</a></td>
	<td class="summary">get or set SSL session ID</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:export">ssl_ctx:export ([pem=true])</a></td>
	<td class="summary">export SSL session to PEM or DER format</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:is_resumable">ssl_ctx:is_resumable ()</a></td>
	<td class="summary">check if SSL session is resumable</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl_ctx:has_ticket">ssl_ctx:has_ticket ()</a></td>
	<td class="summary">check if SSL session has a ticket</td>
	</tr>
</table>
<h2><a href="#Class_ssl">Class ssl </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#ssl:clear">ssl:clear ()</a></td>
	<td class="summary">reset ssl object to allow another connection</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:use">ssl:use (pkey[, cert])</a></td>
	<td class="summary">tell ssl use private key and certificate, and check private key</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:peer">ssl:peer ()</a></td>
	<td class="summary">get peer certificate and certificate chains</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:want">ssl:want ()</a></td>
	<td class="summary">get want to do</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:current_compression">ssl:current_compression ()</a></td>
	<td class="summary">get current compression name</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:current_cipher">ssl:current_cipher ()</a></td>
	<td class="summary">get current cipher info</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:pending">ssl:pending ()</a></td>
	<td class="summary">get number of bytes available inside SSL fro immediate read</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:getfd">ssl:getfd ()</a></td>
	<td class="summary">get socket fd of ssl</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:is_server">ssl:is_server ()</a></td>
	<td class="summary">check SSL is a server</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:get">ssl:get (arg)</a></td>
	<td class="summary">get value according to arg</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:set">ssl:set (arg, value)</a></td>
	<td class="summary">set value according to arg</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:accept">ssl:accept ()</a></td>
	<td class="summary">do ssl server accept</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:connect">ssl:connect ()</a></td>
	<td class="summary">do ssl client connect</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:read">ssl:read ([length=4096])</a></td>
	<td class="summary">do ssl read</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:peek">ssl:peek ([length=4096])</a></td>
	<td class="summary">do ssl peak, data can be read again</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:write">ssl:write (data)</a></td>
	<td class="summary">do ssl write</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:handshake">ssl:handshake ()</a></td>
	<td class="summary">do ssl handshake, support both server and client side</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:renegotiate">ssl:renegotiate ()</a></td>
	<td class="summary">do ssl renegotiate</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:renegotiate_abbreviated">ssl:renegotiate_abbreviated ()</a></td>
	<td class="summary">perform abbreviated SSL renegotiation</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:renegotiate_pending">ssl:renegotiate_pending ()</a></td>
	<td class="summary">get ssl renegotiate_pending</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:renegotiate_pending">ssl:renegotiate_pending ()</a></td>
	<td class="summary">do ssl renegotiate_pending</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:shutdown">ssl:shutdown (mode)</a></td>
	<td class="summary">shutdown ssl connection with quite or noquite mode</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:shutdown">ssl:shutdown ()</a></td>
	<td class="summary">shutdown SSL connection</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:shutdown">ssl:shutdown (mode)</a></td>
	<td class="summary">shutdown ssl connect with special mode, disable read or write,
enable or disable quite shutdown</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:set_connect_state">ssl:set_connect_state ()</a></td>
	<td class="summary">make ssl to client mode</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:set_accept_state">ssl:set_accept_state ()</a></td>
	<td class="summary">make ssl to server mode</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:dup">ssl:dup ()</a></td>
	<td class="summary">duplicate ssl object</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:session_reused">ssl:session_reused ()</a></td>
	<td class="summary">get ssl session resused</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:cache_hit">ssl:cache_hit ()</a></td>
	<td class="summary">check if SSL session was reused (cache hit)</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:set_debug">ssl:set_debug (debug)</a></td>
	<td class="summary">set debug level for SSL connection</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:ctx">ssl:ctx ()</a></td>
	<td class="summary">get ssl_ctx associate with current ssl</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:ctx">ssl:ctx (ctx)</a></td>
	<td class="summary">set ssl_ctx associate to current ssl</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:session">ssl:session ()</a></td>
	<td class="summary">get ssl session</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:session">ssl:session (sesion)</a></td>
	<td class="summary">set ssl session</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:__tostring">ssl:__tostring ()</a></td>
	<td class="summary">convert SSL object to string representation</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ssl:get_alpn_selected">ssl:get_alpn_selected ()</a></td>
	<td class="summary">get the ALPN protocol selected</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Functions"></a>Functions</h2>

    <dl class="function">
    <dt>
    <a name = "ctx_new"></a>
    <strong>ctx_new (protocol[, support_ciphers])</strong>
    </dt>
    <dd>
    create ssl_ctx object, which mapping to SSL_CTX in openssl.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">protocol</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         support &lsquo;SSLv3&rsquo;, &lsquo;SSLv23&rsquo;, &lsquo;SSLv2&rsquo;, &lsquo;TSLv1&rsquo;, &lsquo;TSLv1_1&rsquo;,&lsquo;TSLv1_2&rsquo;,&lsquo;TLS&rsquo;,
&lsquo;DTLSv1&rsquo;,&lsquo;DTLSv1_2&rsquo;, and can be follow by &lsquo;<em>server&rsquo; or &lsquo;</em>client&rsquo;, in general you should use &lsquo;TLS&rsquo; to
negotiate highest available SSL/TLS version
        </li>
        <li><span class="parameter">support_ciphers</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        , if not given, default of openssl will be used
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl_ctx</a></span>


    </ol>




</dd>
    <dt>
    <a name = "new"></a>
    <strong>new ([method="TLS"])</strong>
    </dt>
    <dd>
    create a new SSL context object


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">method</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         SSL/TLS protocol method (&ldquo;TLS&rdquo;, &ldquo;SSLv23&rdquo;, &ldquo;TLSv1&rdquo;, &ldquo;TLSv1_1&rdquo;, &ldquo;TLSv1_2&rdquo;, etc.)
         (<em>default</em> "TLS")
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl_ctx</a></span>
        SSL context object
    </ol>




</dd>
    <dt>
    <a name = "alert_type"></a>
    <strong>alert_type (alert[, long=false])</strong>
    </dt>
    <dd>
    get alert_type for ssl state


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">alert</span>
            <span class="types"><span class="type">number</span></span>


        </li>
        <li><span class="parameter">long</span>
            <span class="types"><span class="type">boolean</span></span>


         (<em>default</em> false)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        alert type
    </ol>




</dd>
    <dt>
    <a name = "alert_desc"></a>
    <strong>alert_desc (alert[, long=false])</strong>
    </dt>
    <dd>
    get alert_desc for ssl state


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">alert</span>
            <span class="types"><span class="type">number</span></span>


        </li>
        <li><span class="parameter">long</span>
            <span class="types"><span class="type">boolean</span></span>


         (<em>default</em> false)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        alert type</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        desc string, if long set true will return long info</li>
    </ol>




</dd>
    <dt>
    <a name = "session_new"></a>
    <strong>session_new ()</strong>
    </dt>
    <dd>
    create new SSL session object



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl_session</a></span>
        new SSL session object
    </ol>




</dd>
    <dt>
    <a name = "session_read"></a>
    <strong>session_read (input)</strong>
    </dt>
    <dd>
    read SSL session from BIO or string data


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">input</span>
            <span class="types"><a class="type" href="../modules/ssl.html#ssl_ctx:bio">bio</a> or <a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         BIO object or string containing session data (PEM or DER format)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl_session</a> or <span class="type">nil</span></span>
        SSL session object or nil on error
    </ol>




</dd>
</dl>
    <h2 class="section-header has-description"><a name="Class_ssl_ctx"></a>Class ssl_ctx </h2>

          <div class="section-description">
          openssl.ssl_ctx object
          </div>
    <dl class="function">
    <dt>
    <a name = "ssl_ctx:use"></a>
    <strong>ssl_ctx:use (pkey, cert)</strong>
    </dt>
    <dd>
    tell ssl_ctx use private key and certificate, and check private key


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">pkey</span>
            <span class="types"><span class="type">evp_pkey</span></span>


        </li>
        <li><span class="parameter">cert</span>
            <span class="types"><span class="type">x509</span></span>


        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result return true for ok, or nil followed by errmsg and errval
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:add"></a>
    <strong>ssl_ctx:add (clientca[, extra_chain_cert_array])</strong>
    </dt>
    <dd>
    add client ca cert and option extra chain cert


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">clientca</span>
            <span class="types"><span class="type">x509</span></span>


        </li>
        <li><span class="parameter">extra_chain_cert_array</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>


         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:timeout"></a>
    <strong>ssl_ctx:timeout ()</strong>
    </dt>
    <dd>
    get timeout



    <h3>Returns:</h3>
    <ol>

        number
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:timeout"></a>
    <strong>ssl_ctx:timeout (timeout)</strong>
    </dt>
    <dd>
    set timeout


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">timeout</span>
            <span class="types"><span class="type">number</span></span>


        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">number</span></span>
        previous timeout
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:mode"></a>
    <strong>ssl_ctx:mode (clear, mode[, ...])</strong>
    </dt>
    <dd>
    clean given mode
mode support
&lsquo;enable_partial_write&rsquo;,&lsquo;accept_moving_write_buffer&rsquo;,&lsquo;auto_retry&rsquo;,&lsquo;no_auto_chain&rsquo;,&lsquo;release_buffers&rsquo;


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">clear</span>
            <span class="types"><span class="type">boolean</span></span>
         must be true
        </li>
        <li><span class="parameter">mode</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>


        </li>
        <li><span class="parameter">...</span>


         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>

</li>
        <li>
           <span class="types"><span class="type">...</span></span>

</li>
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">modes = { ssl_ctx:<span class="function-name">mode</span>(<span class="string">'enable_partial_write'</span>,<span class="string">'accept_moving_write_buffer'</span>,<span class="string">'auto_retry'</span>) },

 <span class="keyword">for</span>  i, v <span class="keyword">in</span> <span class="global">ipairs</span>(modes)
   <span class="global">print</span>(v)
<span class="keyword">end</span>
<span class="comment">--output 'enable_partial_write','accept_moving_write_buffer','auto_retry'</span></pre>
    </ul>

</dd>
    <dt>
    <a name = "ssl_ctx:options"></a>
    <strong>ssl_ctx:options ()</strong>
    </dt>
    <dd>
    get options



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
        string list of current options
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:options"></a>
    <strong>ssl_ctx:options (option)</strong>
    </dt>
    <dd>
    set options


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">option</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        , support &ldquo;microsoft_sess_id_bug&rdquo;, &ldquo;netscape_challenge_bug&rdquo;,
&ldquo;netscape_reuse_cipher_change_bug&rdquo;, &ldquo;sslref2_reuse_cert_type_bug&rdquo;, &ldquo;microsoft_big_sslv3_buffer&rdquo;,
&ldquo;msie_sslv3_rsa_padding&rdquo;,&ldquo;ssleay_080_client_dh_bug&rdquo;,
&ldquo;tls_d5_bug&rdquo;,&ldquo;tls_block_padding_bug&rdquo;,&ldquo;dont_insert_empty_fragments&rdquo;,&ldquo;all&rdquo;, please to see
ssl_options.h
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
        string list of current options after set new option
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:options"></a>
    <strong>ssl_ctx:options (clear, option)</strong>
    </dt>
    <dd>
    clear options


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">clear</span>
            <span class="types"><span class="type">boolean</span></span>
         set true to clear options
        </li>
        <li><span class="parameter">option</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        , support &ldquo;microsoft_sess_id_bug&rdquo;, &ldquo;netscape_challenge_bug&rdquo;,
&ldquo;netscape_reuse_cipher_change_bug&rdquo;, &ldquo;sslref2_reuse_cert_type_bug&rdquo;, &ldquo;microsoft_big_sslv3_buffer&rdquo;,
&ldquo;msie_sslv3_rsa_padding&rdquo;,&ldquo;ssleay_080_client_dh_bug&rdquo;,
&ldquo;tls_d5_bug&rdquo;,&ldquo;tls_block_padding_bug&rdquo;,&ldquo;dont_insert_empty_fragments&rdquo;,&ldquo;all&rdquo;,  please to see
ssl_options.h
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
        string list of current options after clear some option
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:version"></a>
    <strong>ssl_ctx:version ()</strong>
    </dt>
    <dd>
    get min_proto_version and max_proto_version



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">integer</span></span>
        min_proto_version
    </ol>
     <h3>Or</h3>
    <ol>

           <span class="types"><span class="type">integer</span></span>
        man_proto_version
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:options"></a>
    <strong>ssl_ctx:options (min, max)</strong>
    </dt>
    <dd>
    set min_proto_version and max_proto_version


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">min</span>
            <span class="types"><span class="type">integer</span></span>


        </li>
        <li><span class="parameter">max</span>
            <span class="types"><span class="type">integer</span></span>


        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result or fail
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:quiet_shutdown"></a>
    <strong>ssl_ctx:quiet_shutdown ()</strong>
    </dt>
    <dd>
    get quit_shutdown is set or not
Normally when a SSL connection is finished, the parties must send out
&ldquo;close notify&rdquo; alert messages using <strong><em>SSL:shutdown"</em></strong> for a clean shutdown.



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:quiet_shutdown"></a>
    <strong>ssl_ctx:quiet_shutdown (quiet)</strong>
    </dt>
    <dd>
    set quiet_shutdown


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">quiet</span>
            <span class="types"><span class="type">boolean</span></span>
        When setting the &ldquo;quiet shutdown&rdquo; flag to 1, <strong><em>SSL:shutdown</em></strong> will set the internal flags
to SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN. <strong><em>SSL:shutdown</em></strong> then behaves like
<strong>SSL:set_shutdown</strong>* called with SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN.
The session is thus considered to be shutdown, but no &ldquo;close notify&rdquo; alert
is sent to the peer. This behaviour violates the TLS standard.
The default is normal shutdown behaviour as described by the TLS standard.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:verify_locations"></a>
    <strong>ssl_ctx:verify_locations (cafile, capath)</strong>
    </dt>
    <dd>
    set verify locations with cafile and capath
ssl_ctx:verify_locations specifies the locations for <em>ctx</em>, at
which CA certificates for verification purposes are located.  The certificates
available via <em>CAfile</em> and <em>CApath</em> are trusted.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">cafile</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>


        </li>
        <li><span class="parameter">capath</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>


        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:cert_store"></a>
    <strong>ssl_ctx:cert_store ()</strong>
    </dt>
    <dd>
    get certificate verification store of ssl_ctx



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">x509_store</span></span>
        store
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:cert_store"></a>
    <strong>ssl_ctx:cert_store (store)</strong>
    </dt>
    <dd>
    set or replaces then certificate verification store of ssl_ctx


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">store</span>
            <span class="types"><span class="type">x509_store</span></span>


        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">x509_store</span></span>
        store
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:set_engine"></a>
    <strong>ssl_ctx:set_engine (eng)</strong>
    </dt>
    <dd>
    set client certificate engine for SSL context


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">eng</span>
            <span class="types"><span class="type">engine</span></span>
         engine object to use for client certificates
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result true for success
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:ssl"></a>
    <strong>ssl_ctx:ssl (fd[, server=false])</strong>
    </dt>
    <dd>
    create ssl object


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">fd</span>
            <span class="types"><span class="type">number</span></span>


        </li>
        <li><span class="parameter">server</span>
            <span class="types"><span class="type">boolean</span></span>
        , true will make ssl server
         (<em>default</em> false)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl</a></span>


    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:ssl"></a>
    <strong>ssl_ctx:ssl (input[, ouput=input[, server=false]])</strong>
    </dt>
    <dd>
    create ssl object


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">input</span>
            <span class="types"><a class="type" href="../modules/ssl.html#ssl_ctx:bio">bio</a></span>


        </li>
        <li><span class="parameter">ouput</span>
            <span class="types"><a class="type" href="../modules/ssl.html#ssl_ctx:bio">bio</a></span>
        , default will use input as output
         (<em>default</em> input)
        </li>
        <li><span class="parameter">server</span>
            <span class="types"><span class="type">boolean</span></span>
        , true will make ssl server
         (<em>default</em> false)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl</a></span>


    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:bio"></a>
    <strong>ssl_ctx:bio (host_addr[, server=false[, autoretry=true]])</strong>
    </dt>
    <dd>
    create bio object


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">host_addr</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         format like &lsquo;host:port&rsquo;
        </li>
        <li><span class="parameter">server</span>
            <span class="types"><span class="type">boolean</span></span>
        , true listen at host_addr,false connect to host_addr
         (<em>default</em> false)
        </li>
        <li><span class="parameter">autoretry</span>
            <span class="types"><span class="type">boolean</span></span>
         ssl operation autoretry mode
         (<em>default</em> true)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl_ctx:bio">bio</a></span>
        bio object
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:verify_depth"></a>
    <strong>ssl_ctx:verify_depth ()</strong>
    </dt>
    <dd>
    get verify depth when cert chain veirition



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">number</span></span>
        depth
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:verify_depth"></a>
    <strong>ssl_ctx:verify_depth (depth)</strong>
    </dt>
    <dd>
    set verify depth when cert chain veirition


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">depth</span>
            <span class="types"><span class="type">number</span></span>


        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">number</span></span>
        depth
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:verify_mode"></a>
    <strong>ssl_ctx:verify_mode ()</strong>
    </dt>
    <dd>
    get verify_mode, return number mode and all string modes list



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">number</span></span>
        mode_code</li>
        <li>
         &hellip;
  none: not verify client cert
  peer: verify client cert
  fail: if client not have cert, will failure
  once: verify client only once.</li>
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">mode = {ctx:<span class="function-name">verify_mode</span>()}
<span class="global">print</span>(<span class="string">'integer mode'</span>,mode[<span class="number">1</span>])
<span class="keyword">for</span> i=<span class="number">2</span>, #mode <span class="keyword">then</span>
  <span class="global">print</span>(<span class="string">'string mode:'</span>..mode[i])
<span class="keyword">end</span></pre>
    </ul>

</dd>
    <dt>
    <a name = "ssl_ctx:verify_mode"></a>
    <strong>ssl_ctx:verify_mode (mode[, ssl=nil])</strong>
    </dt>
    <dd>
    set ssl verify mode and callback


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">mode</span>
            <span class="types"><span class="type">number</span></span>
        , mode set to ctx, must be ssl.none or ssl.peer, and ssl.peer support combine
with ssl.fail or ssl.once
        </li>
        <li><span class="parameter">ssl</span>
            <span class="types"><span class="type">function</span></span>
         verify callback in lua function, not give will use default openssl
callback, when mode is &lsquo;none&rsquo;, will be ignore this verify_cb must be boolean function(verifyarg)
prototype, return true to continue or false to end ssl handshake verifyarg has field &lsquo;error&rsquo;,
&lsquo;error_string&rsquo;,&lsquo;error_depth&rsquo;,&lsquo;current_cert&rsquo;, and &lsquo;preverify_ok&rsquo;
         (<em>default</em> nil)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:set_cert_verify"></a>
    <strong>ssl_ctx:set_cert_verify ([cert_verify_cb])</strong>
    </dt>
    <dd>
    set certificate verify callback function


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">cert_verify_cb</span>
            <span class="types"><span class="type">function</span></span>
         with boolean function(verifyargs) prototype, if nil or none
will use openssl default callback verifyargs has field &lsquo;error&rsquo;,
&lsquo;error_string&rsquo;,&lsquo;error_depth&rsquo;,&lsquo;current_cert&rsquo;
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">various</span></span>
        return value
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:set_cert_verify"></a>
    <strong>ssl_ctx:set_cert_verify (verify_cb_flag)</strong>
    </dt>
    <dd>
    set certificate verify options


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">verify_cb_flag</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
         support field always_continue with boolean value and verify_depth with
number value.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result true for success
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:set_alpn_protos"></a>
    <strong>ssl_ctx:set_alpn_protos (protos)</strong>
    </dt>
    <dd>
    set the list of client ALPN protocols available to be negotiated by the server


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">protos</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
         the protocol list
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">various</span></span>
        return value
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:set_alpn_select_cb"></a>
    <strong>ssl_ctx:set_alpn_select_cb ([alpn_select_cb])</strong>
    </dt>
    <dd>
    set ALPN server protocol selection callback to select which protocol to use for the incoming
connection


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">alpn_select_cb</span>
            <span class="types"><span class="type">function</span></span>
         callback that receive the prototype list as a table and return
the one selected as a string
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">various</span></span>
        return value
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:set_tmp"></a>
    <strong>ssl_ctx:set_tmp (keytype, tmp_cb[, vararg])</strong>
    </dt>
    <dd>
    set temp callback


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">keytype</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        , &lsquo;dh&rsquo;,&lsquo;ecdh&rsquo;,or &lsquo;rsa&rsquo;
        </li>
        <li><span class="parameter">tmp_cb</span>
            <span class="types"><span class="type">function</span></span>


        </li>
        <li><span class="parameter">vararg</span>


         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">userdata</span></span>
        object created
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:set_tmp"></a>
    <strong>ssl_ctx:set_tmp (keytype[, private])</strong>
    </dt>
    <dd>
    set tmp key content pem format


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">keytype</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        , &lsquo;dh&rsquo;,&lsquo;ecdh&rsquo;,or &lsquo;rsa&rsquo;
        </li>
        <li><span class="parameter">private</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         key file
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result true for success
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:set_servername_callback"></a>
    <strong>ssl_ctx:set_servername_callback (info)</strong>
    </dt>
    <dd>
    set servername callback


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">info</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a> or <span class="type">function</span></span>
         <code>function(name) return ctx end</code> or table
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl_ctx</a> or <span class="type">fail</span></span>


    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:set_session_callback"></a>
    <strong>ssl_ctx:set_session_callback (new, get, remove)</strong>
    </dt>
    <dd>
    set session callback


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">new</span>
            <span class="types"><span class="type">function</span></span>


        </li>
        <li><span class="parameter">get</span>
            <span class="types"><span class="type">function</span></span>


        </li>
        <li><span class="parameter">remove</span>
            <span class="types"><span class="type">function</span></span>


        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">various</span></span>
        return value
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:flush"></a>
    <strong>ssl_ctx:flush ()</strong>
    </dt>
    <dd>
    flush sessions



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">various</span></span>
        return value
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:sessions"></a>
    <strong>ssl_ctx:sessions ()</strong>
    </dt>
    <dd>
    set ssl session



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">various</span></span>
        return value
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:session_cache_mode"></a>
    <strong>ssl_ctx:session_cache_mode ()</strong>
    </dt>
    <dd>
    get current session cache mode



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
        modes as array, mode is &lsquo;no_auto_clear&rsquo;,&lsquo;server&rsquo;,&lsquo;client&rsquo;,&lsquo;both&rsquo;,&lsquo;off&rsquo;
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:session_cache_mode"></a>
    <strong>ssl_ctx:session_cache_mode (mode)</strong>
    </dt>
    <dd>
    set session cache mode,and return old mode


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">mode</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         support &lsquo;no_auto_clear&rsquo;,&lsquo;server&rsquo;,&lsquo;client&rsquo;,&lsquo;both&rsquo;,&lsquo;off&rsquo;,
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
        old modes as array
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:num_tickets"></a>
    <strong>ssl_ctx:num_tickets ([num])</strong>
    </dt>
    <dd>
    get or set number of TLS tickets


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">num</span>
            <span class="types"><span class="type">number</span></span>
         number of tickets to set
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">number</span></span>
        current number of tickets
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:getpeerverification"></a>
    <strong>ssl_ctx:getpeerverification ()</strong>
    </dt>
    <dd>
    get peer certificate verify result



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">boolean</span></span>
        true for success</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
         all certificate in chains verify result
 preverify_ok as boolean verify result
 error as number error code
 error_string as string error message
 error_depth as number verify depth
 current_cert as x509 certificate to verified</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:time"></a>
    <strong>ssl_ctx:time ([time])</strong>
    </dt>
    <dd>
    get or set SSL session time


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">time</span>
            <span class="types"><span class="type">number</span></span>
         session time to set (Unix timestamp)
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">number</span></span>
        current session time (if getting) or previous time (if setting)
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:timeout"></a>
    <strong>ssl_ctx:timeout ([timeout])</strong>
    </dt>
    <dd>
    get or set SSL session timeout


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">timeout</span>
            <span class="types"><span class="type">number</span></span>
         session timeout in seconds to set
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">number</span></span>
        current session timeout (if getting) or previous timeout (if setting)
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:peer"></a>
    <strong>ssl_ctx:peer ()</strong>
    </dt>
    <dd>
    get peer certificate from SSL session



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">x509</span></span>
        peer certificate from the session
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:id"></a>
    <strong>ssl_ctx:id ([id])</strong>
    </dt>
    <dd>
    get or set SSL session ID


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">id</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         optional session ID to set
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        current session ID when called without parameters</li>
        <li>
           <span class="types"><span class="type">boolean</span></span>
        true when setting session ID successfully (OpenSSL 1.1.0+)</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:export"></a>
    <strong>ssl_ctx:export ([pem=true])</strong>
    </dt>
    <dd>
    export SSL session to PEM or DER format


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">pem</span>
            <span class="types"><span class="type">boolean</span></span>
         true for PEM format, false for DER format
         (<em>default</em> true)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        exported session data in specified format
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:is_resumable"></a>
    <strong>ssl_ctx:is_resumable ()</strong>
    </dt>
    <dd>
    check if SSL session is resumable



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        true if session can be resumed
    </ol>




</dd>
    <dt>
    <a name = "ssl_ctx:has_ticket"></a>
    <strong>ssl_ctx:has_ticket ()</strong>
    </dt>
    <dd>
    check if SSL session has a ticket



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        true if session has a ticket
    </ol>




</dd>
</dl>
    <h2 class="section-header has-description"><a name="Class_ssl"></a>Class ssl </h2>

          <div class="section-description">
          openssl.ssl object
All SSL object IO operation methods(connect, accept, handshake, read,
peek or write) return nil or false when fail or error.
When nil returned, it followed by &lsquo;ssl&rsquo; or &lsquo;syscall&rsquo;, means SSL layer or
system layer error. When false returned, it followed by number 0,
&lsquo;want_read&rsquo;,&lsquo;want_write&rsquo;,&lsquo;want_x509_lookup&rsquo;,&lsquo;want_connect&rsquo;,&lsquo;want_accept&rsquo;.
Numnber 0 means SSL connection closed, others means you should do some
SSL operation.
          </div>
    <dl class="function">
    <dt>
    <a name = "ssl:clear"></a>
    <strong>ssl:clear ()</strong>
    </dt>
    <dd>
    reset ssl object to allow another connection



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result true for success
    </ol>




</dd>
    <dt>
    <a name = "ssl:use"></a>
    <strong>ssl:use (pkey[, cert])</strong>
    </dt>
    <dd>
    tell ssl use private key and certificate, and check private key


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">pkey</span>
            <span class="types"><span class="type">evp_pkey</span></span>


        </li>
        <li><span class="parameter">cert</span>
            <span class="types"><span class="type">x509</span></span>


         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result return true for ok, or nil followed by errmsg and errval
    </ol>




</dd>
    <dt>
    <a name = "ssl:peer"></a>
    <strong>ssl:peer ()</strong>
    </dt>
    <dd>
    get peer certificate and certificate chains



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">x509</span></span>
        certificate</li>
        <li>
           <span class="types"><span class="type">sk_of_x509</span></span>
        chains of peer</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:want"></a>
    <strong>ssl:want ()</strong>
    </dt>
    <dd>
    get want to do



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        &lsquo;nothing&rsquo;, &lsquo;reading&rsquo;, &lsquo;writing&rsquo;, &lsquo;x509_lookup&rsquo;</li>
        <li>
           <span class="types"><span class="type">number</span></span>
        state want</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:current_compression"></a>
    <strong>ssl:current_compression ()</strong>
    </dt>
    <dd>
    get current compression name



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>


    </ol>




</dd>
    <dt>
    <a name = "ssl:current_cipher"></a>
    <strong>ssl:current_cipher ()</strong>
    </dt>
    <dd>
    get current cipher info



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
        include name,version,id,bits,algbits and description
    </ol>




</dd>
    <dt>
    <a name = "ssl:pending"></a>
    <strong>ssl:pending ()</strong>
    </dt>
    <dd>
    get number of bytes available inside SSL fro immediate read



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">number</span></span>


    </ol>




</dd>
    <dt>
    <a name = "ssl:getfd"></a>
    <strong>ssl:getfd ()</strong>
    </dt>
    <dd>
    get socket fd of ssl



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">number</span></span>
        fd
    </ol>




</dd>
    <dt>
    <a name = "ssl:is_server"></a>
    <strong>ssl:is_server ()</strong>
    </dt>
    <dd>
    check SSL is a server



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        is_server
    </ol>




</dd>
    <dt>
    <a name = "ssl:get"></a>
    <strong>ssl:get (arg)</strong>
    </dt>
    <dd>
    get value according to arg


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">arg</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         <br/>certificate:  return SSL certificates
 <br/>fd: return file or network connect fd
 <br/>rfd:
 <br/>wfd:
 <br/>client_CA_list
 <br/>read_ahead: &ndash;> boolean
 <br/>shared_ciphers: string
 <br/>cipher_list &ndash;> string
 <br/>verify_mode: number
 <br/>verify_depth
 <br/>state_string
 <br/>state_string_long
 <br/>rstate_string
 <br/>rstate_string_long
 <br/>iversion
 <br/>version
 <br/>default_timeout,
 <br/>certificate
 <br/>verify_result
 <br/>state
 <br/>hostname
 <br/>state_string
 <br/>side
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        according to arg
    </ol>




</dd>
    <dt>
    <a name = "ssl:set"></a>
    <strong>ssl:set (arg, value)</strong>
    </dt>
    <dd>
    set value according to arg


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">arg</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         <br/>certificate:  return SSL certificates
 <br/>fd: return file or network connect fd
 <br/>rfd:
 <br/>wfd:
 <br/>client_CA:
 <br/>read_ahead:
 <br/>cipher_list:
 <br/>verify_depth:
 <br/>purpose:
 <br/>trust:
 <br/>verify_result:
 <br/>hostname:
        </li>
        <li><span class="parameter">value</span>
         val type accroding to arg
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        value
    </ol>




</dd>
    <dt>
    <a name = "ssl:accept"></a>
    <strong>ssl:accept ()</strong>
    </dt>
    <dd>
    do ssl server accept



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">boolean</span></span>
        true for success</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        fail reason</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:connect"></a>
    <strong>ssl:connect ()</strong>
    </dt>
    <dd>
    do ssl client connect



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">boolean</span></span>
        true for success</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        fail reasion</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:read"></a>
    <strong>ssl:read ([length=4096])</strong>
    </dt>
    <dd>
    do ssl read


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">length</span>
            <span class="types"><span class="type">number</span></span>
         to read
         (<em>default</em> 4096)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        data, nil or false for fail</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        fail reason</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:peek"></a>
    <strong>ssl:peek ([length=4096])</strong>
    </dt>
    <dd>
    do ssl peak, data can be read again


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">length</span>
            <span class="types"><span class="type">number</span></span>
         to read
         (<em>default</em> 4096)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        data, nil or false for fail</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        fail reason</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:write"></a>
    <strong>ssl:write (data)</strong>
    </dt>
    <dd>
    do ssl write


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">data</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>


        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">number</span></span>
        count of bytes write successfully</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        fail reason</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:handshake"></a>
    <strong>ssl:handshake ()</strong>
    </dt>
    <dd>
    do ssl handshake, support both server and client side



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">boolean</span></span>
        true for success</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        fail reasion</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:renegotiate"></a>
    <strong>ssl:renegotiate ()</strong>
    </dt>
    <dd>
    do ssl renegotiate



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">boolean</span></span>
        true for success</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        fail reasion</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:renegotiate_abbreviated"></a>
    <strong>ssl:renegotiate_abbreviated ()</strong>
    </dt>
    <dd>
    perform abbreviated SSL renegotiation



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result true for success
    </ol>




</dd>
    <dt>
    <a name = "ssl:renegotiate_pending"></a>
    <strong>ssl:renegotiate_pending ()</strong>
    </dt>
    <dd>
    get ssl renegotiate_pending



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">boolean</span></span>
        true for success</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        fail reasion</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:renegotiate_pending"></a>
    <strong>ssl:renegotiate_pending ()</strong>
    </dt>
    <dd>
    do ssl renegotiate_pending



    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">boolean</span></span>
        true for success</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        fail reasion</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:shutdown"></a>
    <strong>ssl:shutdown (mode)</strong>
    </dt>
    <dd>
    shutdown ssl connection with quite or noquite mode


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">mode</span>
            <span class="types"><span class="type">boolean</span></span>


        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">boolean</span></span>
        if mode is true, return true or false for quite</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        if mode is false, return &lsquo;read&rsquo; or &lsquo;write&rsquo; for shutdown direction</li>
    </ol>




</dd>
    <dt>
    <a name = "ssl:shutdown"></a>
    <strong>ssl:shutdown ()</strong>
    </dt>
    <dd>
    shutdown SSL connection



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result true for success
    </ol>




</dd>
    <dt>
    <a name = "ssl:shutdown"></a>
    <strong>ssl:shutdown (mode)</strong>
    </dt>
    <dd>
    shutdown ssl connect with special mode, disable read or write,
enable or disable quite shutdown


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">mode</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         support &lsquo;read&rsquo;,&lsquo;write&rsquo;, &lsquo;quite&rsquo;, &lsquo;noquite&rsquo;
        </li>
    </ul>





</dd>
    <dt>
    <a name = "ssl:set_connect_state"></a>
    <strong>ssl:set_connect_state ()</strong>
    </dt>
    <dd>
    make ssl to client mode



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">various</span></span>
        return value
    </ol>




</dd>
    <dt>
    <a name = "ssl:set_accept_state"></a>
    <strong>ssl:set_accept_state ()</strong>
    </dt>
    <dd>
    make ssl to server mode



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">various</span></span>
        return value
    </ol>




</dd>
    <dt>
    <a name = "ssl:dup"></a>
    <strong>ssl:dup ()</strong>
    </dt>
    <dd>
    duplicate ssl object



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl</a></span>


    </ol>




</dd>
    <dt>
    <a name = "ssl:session_reused"></a>
    <strong>ssl:session_reused ()</strong>
    </dt>
    <dd>
    get ssl session resused



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        success status
    </ol>




</dd>
    <dt>
    <a name = "ssl:cache_hit"></a>
    <strong>ssl:cache_hit ()</strong>
    </dt>
    <dd>
    check if SSL session was reused (cache hit)



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        true if session was not reused (cache miss)
    </ol>




</dd>
    <dt>
    <a name = "ssl:set_debug"></a>
    <strong>ssl:set_debug (debug)</strong>
    </dt>
    <dd>
    set debug level for SSL connection


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">debug</span>
            <span class="types"><span class="type">number</span></span>
         debug level to set
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">number</span></span>
        always returns 0
    </ol>




</dd>
    <dt>
    <a name = "ssl:ctx"></a>
    <strong>ssl:ctx ()</strong>
    </dt>
    <dd>
    get ssl_ctx associate with current ssl



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl_ctx</a></span>


    </ol>




</dd>
    <dt>
    <a name = "ssl:ctx"></a>
    <strong>ssl:ctx (ctx)</strong>
    </dt>
    <dd>
    set ssl_ctx associate to current ssl


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">ctx</span>
            <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl_ctx</a></span>


        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl_ctx</a></span>
        orgine ssl_ctx object
    </ol>




</dd>
    <dt>
    <a name = "ssl:session"></a>
    <strong>ssl:session ()</strong>
    </dt>
    <dd>
    get ssl session



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/ssl.html#ssl">ssl_session</a></span>
        session object
    </ol>




</dd>
    <dt>
    <a name = "ssl:session"></a>
    <strong>ssl:session (sesion)</strong>
    </dt>
    <dd>
    set ssl session


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">sesion</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a> or <a class="type" href="../modules/ssl.html#ssl">ssl_session</a></span>
         reuse session would speed up ssl handshake
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        result
    </ol>




</dd>
    <dt>
    <a name = "ssl:__tostring"></a>
    <strong>ssl:__tostring ()</strong>
    </dt>
    <dd>
    convert SSL object to string representation



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        string representation of SSL object
    </ol>




</dd>
    <dt>
    <a name = "ssl:get_alpn_selected"></a>
    <strong>ssl:get_alpn_selected ()</strong>
    </dt>
    <dd>
    get the ALPN protocol selected



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">the</span></span>
        ALPN protocol selected or nil
    </ol>




</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/lunarmodules/LDoc">LDoc 1.5.0</a></i>
<i style="float:right;">Last updated 2025-11-02 11:59:05 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
